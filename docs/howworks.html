<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
    <TITLE>Какэтоработает</TITLE>
    <META content="text/html; charset=Windows-1252" http-equiv="Content-Type">
    <LINK rel="stylesheet" type="text/css" href="styleos.css">
	<script defer src="mobil.js"></script>
</HEAD>
<body>
    <header>
        <section>
            <div>
                <div id="logo"><big><big><big>Интегратор<br><small><small>для сценарного языка</small></small> OneScript </big></big></big></div>
            </div>
            <div style="direction: rtl; overflow:hidden; padding: 8px 0px 0px 0px; margin-top:-7px;">
				<DIV id=div22>
					<input type="checkbox" id="toggle">
					<label id="label1" class="hamburger-icon" onclick="label1click()"><div></div><div></div><div></div></label>
				</DIV>
                <nav>
                    <a onclick="navclick(event)" href="index.html">Главная</a>
                    <a onclick="navclick(event)" href="screenshot.html">Скриншоты</a>
                    <a onclick="navclick(event)" href="howworks.html">Как это работает</a>
                    <a onclick="navclick(event)" href="doc.html">Документация</a>
                    <a onclick="navclick(event)" href="down.html">Скачать</a>
                    <a onclick="navclick(event)" href="kont.html">Контакты</a>
					<input type="checkbox" id="toggle2">
                    <a id="mobil" onclick="mobilClick()">`</a>
                </nav>
            </div>
        </section>
    </header>
    <section class="content">
		<p>
			При создании проекта включающего несколько сценариев можно подключить их все сразу применив директиву <B>#Использовать</B>. И 
			если будет необходим доступ к переменным между сценариями это нужно будет дописывать, делая переменные экспортными и 
			присваивая им значения. В другом случае можно методом <B>ЗагрузитьСценарий</B> загрузить сценарий и внедрить глобальную 
			переменную в область видимости загружаемого сценария.
		</p>
		<H3 class=dtH4>Новая загрузка сценариев.</H3>			
		<p>
			В этой работе сделана попытка совместить оба подхода. Создадим объект библиотеки <B>ИнтеграторОдноСкрипта</B> и вызовем 
			метод <B>ЗагрузитьСценарии</B>.
		</p>
		<div>
<pre class="code">
ИОС = Новый ИнтеграторОдноСкрипта();
ОбщаяСтруктура = ИОС.ОбщаяСтруктура;
ОбщаяСтруктура.Вставить("ИОС", ИОС);
Сценарии = ИОС.ЗагрузитьСценарии(
    ЭтотОбъект, ".\");
</pre>
		</div>
		<p>Сохраните этот код в файл с расширением ".os".</p>
		<p>
			В примере переменная <B>ОбщаяСтруктура</B> получает значение предопределенного в библиотеке объекта <B>Структура</B> и она 
			будет доступна во всех загруженных таким способом сценариях напрямую, без объявлений. Её можно будет изменять и 
			изменения отразятся во всех сценариях.
		</p>
		<p>
			Переменная <B>Сценарии</B> это тоже структура. После просмотра заданного каталога она будет содержать ключами названия 
			сценариев, значениями сами сценарии. Доступ получается красивый: <B>Сценарии.Главный</B> или <B>Сценарии["Главный"]</B>.
		</p>
		<p>Это что касается автоматики.</p>
		<H3 class=dtH4>Внедрение глобальных переменных.</H3>			
		<p>
			Но также в библиотеке есть возможность добавить глобальную переменную поддерживаемого односкриптом типа в область 
			видимости подключаемых сценариев в ручном режиме. Для этого примените метод <B>ВвестиГлобальноеСвойство</B>.
		</p>
		<div>
<pre class="code">
Структура1 = Новый Структура();
Структура1.Вставить(
    "Ключ", 
    "Значение ключа");
ИОС.ВвестиГлобальноеСвойство(
    Структура1, 
    "МояСтруктура", 
    Ложь);
</pre>
		</div>
		<p>
			Только делать это нужно до метода <B>ЗагрузитьСценарии</B>.
		</p>
		<H3 class=dtH4>Передача данных в метод через аргументы.</H3>			
		<p>
			Ещё одна возможность этой работы это передача в метод другого сценария дополнительных данных, что то навроде аргументов 
			события. Назовем их условно аргументами делегата. Можно создать делегат для выполнения в другом сценарии и при его 
			выполнении в методе будут доступны агрументы где в свойстве <B>Параметр</B> будут доступны данные.
		</p>
		<div>
<pre class="code">
//== Файл Стартовый.os
// ...
ОбщаяСтруктура = ИОС.ОбщаяСтруктура;
ОбщаяСтруктура.Вставить("ИОС", ИОС);
Сценарии = ИОС.ЗагрузитьСценарии(
    ЭтотОбъект, ".\");

Параметры = Новый Структура();
Параметры.Вставить(
    "Ключ1", 
    "Значение1");
Действие1 = ИОС.Действие(
    Сценарии.Главный, 
    "МояПроцедура", 
    Параметры);
Рез = ИОС.Выполнить(Действие1);
//...

//== Файл Главный.os
Функция МояПроцедура() Экспорт
    Пар = 
    ОбщаяСтруктура.ИОС.Аргументы.Параметр;
    Возврат Пар.Ключ1;
КонецФункции
</pre>
		</div>
		<p>
			Так можно будет передавать данные в метод у которого параметров и нет вовсе.
		</p>
		<p></p>
    </section>
</body>
</HTML>